const JSON_URL="autores/ghustilool.json?v=70";const TAG_COLOR={Offline:"Offline",LAN:"LAN",Online:"Online","+18":"+18",Programas:"Programas",Tutorial:"Tutorial"};const state={all:[],filtered:[],selectedId:null,filterTag:null};function safe(e,t=""){return void 0===e||null===e?t:e}function arr(e){return Array.isArray(e)?e:[]}function byDateDesc(e,t){return new Date(safe(e.fecha||e.updated,0)).getTime()<new Date(safe(t.fecha||t.updated,0)).getTime()?1:-1}async function loadData(){const e=await fetch(JSON_URL),t=await e.json();state.all=Array.isArray(t)?t.slice():t.publicaciones||[],state.all.sort(byDateDesc),state.filtered=state.all.slice(),renderCarousel(),renderList(),bindFilters()}document.addEventListener("DOMContentLoaded",loadData);function renderCarousel(){const e=document.getElementById("car-track");e.innerHTML="";state.all.slice(0,10).forEach(t=>{const n=document.createElement("article");n.className="car-card";const a=document.createElement("img");a.src=safe(t.imagen,"https://picsum.photos/600/300?blur=2"),a.alt=safe(t.nombre,"Publicaci√≥n");const r=document.createElement("div");r.className="car-info";const i=document.createElement("div");i.className="car-title",i.textContent=safe(t.nombre,t.id||"Sin nombre");const s=document.createElement("div");s.className="car-meta";const l=document.createElement("span");l.className="ver-chip",l.textContent=safe(t.version,"v1.0"),s.appendChild(l),r.appendChild(i),r.appendChild(s),n.appendChild(a),n.appendChild(r),e.appendChild(n)});const t=document.querySelector(".car-prev"),n=document.querySelector(".car-next");t.onclick=()=>e.scrollBy({left:-280,behavior:"smooth"}),n.onclick=()=>e.scrollBy({left:280,behavior:"smooth"})}function renderList(){const e=document.getElementById("pub-list");e.innerHTML="",state.filtered.forEach(t=>{const n=document.createElement("li");n.className="pub-item",n.tabIndex=0,n.dataset.id=safe(t.id,safe(t.nombre,"").toLowerCase().replace(/\s+/g,"-"));const a=document.createElement("img");a.className="pub-cover",a.src=safe(t.imagen,"https://picsum.photos/160/100?blur=2"),a.alt=safe(t.nombre,"Publicaci√≥n");const r=document.createElement("div"),i=document.createElement("div");i.className="pub-title",i.textContent=safe(t.nombre,t.id||"Sin nombre");const s=document.createElement("div");s.className="pub-sub";const l=arr(t.tags)[0]||"Offline";s.innerHTML=`<span class="tag-pill tag-${TAG_COLOR[l]||"Offline"}">${l}</span>`,r.appendChild(i),r.appendChild(s);const o=document.createElement("div");o.className="right-chip";const c=document.createElement("span");c.className="version-chip",c.textContent=safe(t.version,"v1.0"),o.appendChild(c),n.appendChild(a),n.appendChild(r),n.appendChild(o),n.addEventListener("click",()=>openMiniModal(t)),n.addEventListener("keydown",e=>{"Enter"===e.key&&openMiniModal(t)}),e.appendChild(n)})}function openMiniModal(e){const t=document.getElementById("mini-modal");document.querySelector(".list-wrap")?.classList.add("mini-open"),t.setAttribute("aria-hidden","false"),t.innerHTML="";const n=document.createElement("div");n.className="mini-head";const a=document.createElement("img");a.src=safe(e.imagen,"https://picsum.photos/200/200?blur=2"),a.alt=safe(e.nombre,"Publicaci√≥n");const r=document.createElement("div"),i=document.createElement("div");i.className="mini-title",i.textContent=safe(e.nombre,e.id||"Sin nombre");const s=document.createElement("div");s.className="mini-sub";const l=arr(e.tags)[0]||"Offline";s.innerHTML=`<span class="tag-pill tag-${TAG_COLOR[l]||"Offline"}">${l}</span>  ‚Ä¢  Versi√≥n: <b>${safe(e.version,"v1.0")}</b>`,r.appendChild(i),r.appendChild(s),n.appendChild(a),n.appendChild(r);const o=document.createElement("div");o.className="btns";const c=document.createElement("button");c.className="btn btn--dl",c.textContent="üì• DESCARGAR",c.addEventListener("click",()=>{const t=safe(e.descargar,e.link||"#");try{window.openAdInterstitial?window.openAdInterstitial(t):window.open(t,"_blank","noopener")}catch{window.open(t,"_blank","noopener")}});const d=document.createElement("button");d.className="btn btn--pwd",d.textContent="üîë CONTRASE√ëA",d.addEventListener("click",()=>{const t=safe(e.contrase√±a,e.password||"");if(!t)return void alert("No hay contrase√±a");navigator.clipboard.writeText(t).then(()=>{d.textContent="‚úÖ CONTRASE√ëA COPIADA",setTimeout(()=>d.textContent="üîë CONTRASE√ëA",1400)})});const p=document.createElement("button");p.className="btn btn--buy",p.textContent="üõí COMPRAR",p.addEventListener("click",()=>{const t=safe(e.comprar,e.store||"#");t&&"#"!==t&&window.open(t,"_blank","noopener")}),o.appendChild(c),o.appendChild(d),o.appendChild(p),t.appendChild(n),t.appendChild(o),document.addEventListener("keydown",escCloser,{once:!0})}function escCloser(e){if("Escape"===e.key){document.querySelector(".list-wrap")?.classList.remove("mini-open");const t=document.getElementById("mini-modal");t.setAttribute("aria-hidden","true"),t.innerHTML=""}}function bindFilters(){const e=document.getElementById("search"),t=document.getElementById("searchBtn");t.addEventListener("click",()=>applyFilters()),e.addEventListener("input",()=>applyFilters()),document.querySelectorAll(".tag-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.filter;state.filterTag=state.filterTag===t?null:t,document.querySelectorAll(".tag-btn").forEach(e=>e.classList.remove("active")),state.filterTag&&e.classList.add("active"),applyFilters()})})}function applyFilters(){const e=(document.getElementById("search").value||"").toLowerCase().trim();state.filtered=state.all.filter(t=>{return(safe(t.nombre,"")+" "+arr(t.tags).join(" ")+" "+safe(t.version,"")).toLowerCase().includes(e)&&(state.filterTag?arr(t.tags).includes(state.filterTag):!0)}),renderList()}